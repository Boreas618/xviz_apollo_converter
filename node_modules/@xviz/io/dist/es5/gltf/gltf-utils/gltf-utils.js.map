{"version":3,"file":"gltf-utils.js","names":["TYPES","ARRAY_TO_COMPONENT_TYPE","Map","Int8Array","Uint8Array","Int16Array","Uint16Array","Uint32Array","Float32Array","ATTRIBUTE_TYPE_TO_COMPONENTS","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE","ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY","getAccessorTypeFromSize","size","type","getComponentTypeFromArray","typedArray","componentType","get","constructor","Error","getAccessorArrayTypeAndLength","accessor","bufferView","ArrayType","components","bytesPerComponent","length","count","byteLength","assert","getFullUri","uri","base","absolute","startsWith","substr","lastIndexOf"],"sources":["../../../../src/gltf/gltf-utils/gltf-utils.js"],"sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport {assert} from '../assert';\n\nconst TYPES = ['SCALAR', 'VEC2', 'VEC3', 'VEC4'];\n\nconst ARRAY_TO_COMPONENT_TYPE = new Map([\n  [Int8Array, 5120],\n  [Uint8Array, 5121],\n  [Int16Array, 5122],\n  [Uint16Array, 5123],\n  [Uint32Array, 5125],\n  [Float32Array, 5126]\n]);\n\nexport const ATTRIBUTE_TYPE_TO_COMPONENTS = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4,\n  MAT2: 4,\n  MAT3: 9,\n  MAT4: 16\n};\n\nexport const ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE = {\n  5120: 1,\n  5121: 1,\n  5122: 2,\n  5123: 2,\n  5125: 4,\n  5126: 4\n};\n\nexport const ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY = {\n  5120: Int8Array,\n  5121: Uint8Array,\n  5122: Int16Array,\n  5123: Uint16Array,\n  5125: Uint32Array,\n  5126: Float32Array\n};\n\nexport function getAccessorTypeFromSize(size) {\n  const type = TYPES[size - 1];\n  return type || TYPES[0];\n}\n\nexport function getComponentTypeFromArray(typedArray) {\n  const componentType = ARRAY_TO_COMPONENT_TYPE.get(typedArray.constructor);\n  if (!componentType) {\n    throw new Error('Illegal typed array');\n  }\n  return componentType;\n}\n\nexport function getAccessorArrayTypeAndLength(accessor, bufferView) {\n  const ArrayType = ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY[accessor.componentType];\n  const components = ATTRIBUTE_TYPE_TO_COMPONENTS[accessor.type];\n  const bytesPerComponent = ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE[accessor.componentType];\n  const length = accessor.count * components;\n  const byteLength = accessor.count * components * bytesPerComponent;\n  assert(byteLength >= 0 && byteLength <= bufferView.byteLength);\n  return {ArrayType, length, byteLength};\n}\n\nexport function getFullUri(uri, base) {\n  // TODO: Use better logic to handle all protocols plus not delay on data\n  const absolute = uri.startsWith('data:') || uri.startsWith('http:') || uri.startsWith('https:');\n  return absolute ? uri : base.substr(0, base.lastIndexOf('/') + 1) + uri;\n}\n"],"mappings":";;;;;;;;;;;AAaA;;AAEA,IAAMA,KAAK,GAAG,CAAC,QAAD,EAAW,MAAX,EAAmB,MAAnB,EAA2B,MAA3B,CAAd;AAEA,IAAMC,uBAAuB,GAAG,IAAIC,GAAJ,CAAQ,CACtC,CAACC,SAAD,EAAY,IAAZ,CADsC,EAEtC,CAACC,UAAD,EAAa,IAAb,CAFsC,EAGtC,CAACC,UAAD,EAAa,IAAb,CAHsC,EAItC,CAACC,WAAD,EAAc,IAAd,CAJsC,EAKtC,CAACC,WAAD,EAAc,IAAd,CALsC,EAMtC,CAACC,YAAD,EAAe,IAAf,CANsC,CAAR,CAAhC;AASO,IAAMC,4BAA4B,GAAG;EAC1CC,MAAM,EAAE,CADkC;EAE1CC,IAAI,EAAE,CAFoC;EAG1CC,IAAI,EAAE,CAHoC;EAI1CC,IAAI,EAAE,CAJoC;EAK1CC,IAAI,EAAE,CALoC;EAM1CC,IAAI,EAAE,CANoC;EAO1CC,IAAI,EAAE;AAPoC,CAArC;;AAUA,IAAMC,qCAAqC,GAAG;EACnD,MAAM,CAD6C;EAEnD,MAAM,CAF6C;EAGnD,MAAM,CAH6C;EAInD,MAAM,CAJ6C;EAKnD,MAAM,CAL6C;EAMnD,MAAM;AAN6C,CAA9C;;AASA,IAAMC,iCAAiC,GAAG;EAC/C,MAAMf,SADyC;EAE/C,MAAMC,UAFyC;EAG/C,MAAMC,UAHyC;EAI/C,MAAMC,WAJyC;EAK/C,MAAMC,WALyC;EAM/C,MAAMC;AANyC,CAA1C;;;AASA,SAASW,uBAAT,CAAiCC,IAAjC,EAAuC;EAC5C,IAAMC,IAAI,GAAGrB,KAAK,CAACoB,IAAI,GAAG,CAAR,CAAlB;EACA,OAAOC,IAAI,IAAIrB,KAAK,CAAC,CAAD,CAApB;AACD;;AAEM,SAASsB,yBAAT,CAAmCC,UAAnC,EAA+C;EACpD,IAAMC,aAAa,GAAGvB,uBAAuB,CAACwB,GAAxB,CAA4BF,UAAU,CAACG,WAAvC,CAAtB;;EACA,IAAI,CAACF,aAAL,EAAoB;IAClB,MAAM,IAAIG,KAAJ,CAAU,qBAAV,CAAN;EACD;;EACD,OAAOH,aAAP;AACD;;AAEM,SAASI,6BAAT,CAAuCC,QAAvC,EAAiDC,UAAjD,EAA6D;EAClE,IAAMC,SAAS,GAAGb,iCAAiC,CAACW,QAAQ,CAACL,aAAV,CAAnD;EACA,IAAMQ,UAAU,GAAGvB,4BAA4B,CAACoB,QAAQ,CAACR,IAAV,CAA/C;EACA,IAAMY,iBAAiB,GAAGhB,qCAAqC,CAACY,QAAQ,CAACL,aAAV,CAA/D;EACA,IAAMU,MAAM,GAAGL,QAAQ,CAACM,KAAT,GAAiBH,UAAhC;EACA,IAAMI,UAAU,GAAGP,QAAQ,CAACM,KAAT,GAAiBH,UAAjB,GAA8BC,iBAAjD;EACA,IAAAI,cAAA,EAAOD,UAAU,IAAI,CAAd,IAAmBA,UAAU,IAAIN,UAAU,CAACM,UAAnD;EACA,OAAO;IAACL,SAAS,EAATA,SAAD;IAAYG,MAAM,EAANA,MAAZ;IAAoBE,UAAU,EAAVA;EAApB,CAAP;AACD;;AAEM,SAASE,UAAT,CAAoBC,GAApB,EAAyBC,IAAzB,EAA+B;EAEpC,IAAMC,QAAQ,GAAGF,GAAG,CAACG,UAAJ,CAAe,OAAf,KAA2BH,GAAG,CAACG,UAAJ,CAAe,OAAf,CAA3B,IAAsDH,GAAG,CAACG,UAAJ,CAAe,QAAf,CAAvE;EACA,OAAOD,QAAQ,GAAGF,GAAH,GAASC,IAAI,CAACG,MAAL,CAAY,CAAZ,EAAeH,IAAI,CAACI,WAAL,CAAiB,GAAjB,IAAwB,CAAvC,IAA4CL,GAApE;AACD"}
{"version":3,"file":"index.js","names":["XVIZJSONProvider","XVIZBinaryProvider","XVIZProtobufProvider","createXVIZProvider","ProviderClass","args","provider","init","valid","XVIZProviderFactoryClass","constructor","providerClasses","className","addProviderClass","push","open","providerEntry","options","loader","XVIZProviderFactory"],"sources":["../../../src/providers/index.js"],"sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport {XVIZJSONProvider} from './xviz-json-provider';\nimport {XVIZBinaryProvider} from './xviz-binary-provider';\nimport {XVIZProtobufProvider} from './xviz-protobuf-provider';\n\nasync function createXVIZProvider(ProviderClass, args) {\n  let provider = null;\n  provider = new ProviderClass(args);\n  await provider.init();\n\n  if (provider.valid()) {\n    return provider;\n  }\n\n  return null;\n}\n\nexport class XVIZProviderFactoryClass {\n  constructor() {\n    this.providerClasses = [\n      {className: XVIZJSONProvider},\n      {className: XVIZBinaryProvider},\n      {className: XVIZProtobufProvider}\n    ];\n  }\n\n  addProviderClass(className, args) {\n    this.providerClasses.push({className, args});\n  }\n\n  /*\n   * Attempt to find a valid provider for the given source\n   * returning null if none can be found.\n   *\n   * @param args.root\n   * @param args.source\n   * @param args.options\n   */\n  async open(args) {\n    for (const providerEntry of this.providerClasses) {\n      const options = {...args.options, ...providerEntry.args};\n      const loader = await createXVIZProvider(providerEntry.className, {...args, options});\n\n      if (loader) {\n        return loader;\n      }\n    }\n\n    return null;\n  }\n}\n\nexport const XVIZProviderFactory = new XVIZProviderFactoryClass();\n"],"mappings":";;;;;;AAaA,SAAQA,gBAAR,QAA+B,sBAA/B;AACA,SAAQC,kBAAR,QAAiC,wBAAjC;AACA,SAAQC,oBAAR,QAAmC,0BAAnC;;AAEA,eAAeC,kBAAf,CAAkCC,aAAlC,EAAiDC,IAAjD,EAAuD;EACrD,IAAIC,QAAQ,GAAG,IAAf;EACAA,QAAQ,GAAG,IAAIF,aAAJ,CAAkBC,IAAlB,CAAX;EACA,MAAMC,QAAQ,CAACC,IAAT,EAAN;;EAEA,IAAID,QAAQ,CAACE,KAAT,EAAJ,EAAsB;IACpB,OAAOF,QAAP;EACD;;EAED,OAAO,IAAP;AACD;;AAED,OAAO,MAAMG,wBAAN,CAA+B;EACpCC,WAAW,GAAG;IACZ,KAAKC,eAAL,GAAuB,CACrB;MAACC,SAAS,EAAEZ;IAAZ,CADqB,EAErB;MAACY,SAAS,EAAEX;IAAZ,CAFqB,EAGrB;MAACW,SAAS,EAAEV;IAAZ,CAHqB,CAAvB;EAKD;;EAEDW,gBAAgB,CAACD,SAAD,EAAYP,IAAZ,EAAkB;IAChC,KAAKM,eAAL,CAAqBG,IAArB,CAA0B;MAACF,SAAD;MAAYP;IAAZ,CAA1B;EACD;;EAUS,MAAJU,IAAI,CAACV,IAAD,EAAO;IACf,KAAK,MAAMW,aAAX,IAA4B,KAAKL,eAAjC,EAAkD;MAChD,MAAMM,OAAO,mCAAOZ,IAAI,CAACY,OAAZ,GAAwBD,aAAa,CAACX,IAAtC,CAAb;;MACA,MAAMa,MAAM,GAAG,MAAMf,kBAAkB,CAACa,aAAa,CAACJ,SAAf,kCAA8BP,IAA9B;QAAoCY;MAApC,GAAvC;;MAEA,IAAIC,MAAJ,EAAY;QACV,OAAOA,MAAP;MACD;IACF;;IAED,OAAO,IAAP;EACD;;AAhCmC;AAmCtC,OAAO,MAAMC,mBAAmB,GAAG,IAAIV,wBAAJ,EAA5B"}